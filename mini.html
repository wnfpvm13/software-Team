<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini 2D Tamagotchi â€” Single File</title>
  <style>
    :root{--bg:#f3f6fb;--card:#fff;--accent:#6c8cff;--danger:#ff6b6b}
    *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans KR', 'Malgun Gothic', sans-serif}
    body{margin:0;background:linear-gradient(180deg,var(--bg) 0%, #e9f1ff 100%);padding:20px;display:flex;align-items:center;justify-content:center;height:100vh}
    .wrap{width:100%;max-width:960px;background:var(--card);border-radius:14px;box-shadow:0 8px 30px rgba(24,39,75,.08);padding:18px;display:grid;grid-template-columns:360px 1fr;gap:18px}
    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    .pet-card{background:linear-gradient(180deg,#fff 0,#f7fbff 100%);border-radius:12px;padding:18px;display:flex;flex-direction:column;align-items:center;gap:12px}
    .pet-view{width:240px;height:240px;border-radius:12px;background:linear-gradient(180deg,#fff,#f1f7ff);display:flex;align-items:center;justify-content:center;position:relative;box-shadow:inset 0 -10px 30px rgba(49,84,255,.03);overflow:hidden}
    /* overlay for background-change animations */
    .bg-overlay{position:absolute;inset:0;border-radius:12px;background-size:cover;background-position:center;opacity:0;transition:opacity .35s ease;pointer-events:none;z-index:0}
    /* simple pet using SVG-like markup (emoji + CSS) */
    .pet-face{font-size:96px;filter:drop-shadow(0 6px 10px rgba(34,60,120,.12));transform-origin:center;transition:transform .2s;z-index:1;position:relative}
    .breath{animation:breath 3000ms ease-in-out infinite}
    @keyframes breath{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}

    .stats{width:100%;display:grid;gap:8px}
    .stat{display:flex;align-items:center;gap:10px}
    .stat strong{width:90px;font-size:13px}
    .bar{flex:1;height:12px;background:#e6eefc;border-radius:999px;overflow:hidden}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#7ae7c7)}

    .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
    .btn{padding:9px 12px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(108,140,255,.12)}
    .btn.secondary{background:#fff;color:var(--accent);border:1px solid rgba(108,140,255,.12)}
    .log{height:120px;overflow:auto;padding:10px;background:#fbfdff;border-radius:10px;border:1px dashed #e9f3ff}

    /* right column */
    .right{display:flex;flex-direction:column;gap:12px}
    .panel{background:#fff;border-radius:10px;padding:12px;box-shadow:0 6px 16px rgba(12,40,90,.02)}
    .row{display:flex;align-items:center;justify-content:space-between}

    footer{grid-column:1/-1;text-align:right;font-size:12px;color:#5b6b86}
    @media (max-width:880px){.wrap{grid-template-columns:1fr;padding:12px}.pet-card{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1></h1>
      <div>
        <button id="saveBtn" class="btn secondary">ì €ì¥</button>
        <button id="resetBtn" class="btn secondary">ì´ˆê¸°í™”</button>
        <a href="index.html">
          <button id="backBtn" class="btn secondary">ë’¤ë¡œê°€ê¸°</button>
        </a>
      </div>
    </header>

    <section class="pet-card">
      <div class="pet-view" id="petView" title="Pet">
        <!-- background overlay: ì‚¬ìš©ìê°€ ë°”ê¿€ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— ì ìš©ë˜ê³  í˜ì´ë“œ ì¸/ì•„ì›ƒ ë©ë‹ˆë‹¤ -->
        <div id="bgOverlay" class="bg-overlay"></div>

        <!-- ì‹¤ì œ ì´ëª¨ì§€(ë˜ëŠ” ì´ë¯¸ì§€)ë¥¼ í‘œì‹œí•˜ëŠ” ì˜ì—­ -->
          <div id="petFace" class="pet-face breath">
          </div>
      </div>

      <div class="stats panel">
        <div class="stat"><strong>í¬ë§Œê°</strong><div class="bar"><i id="hungerBar" style="width:50%"></i></div><div id="hungerVal">50</div></div>
        <div class="stat"><strong>í–‰ë³µ</strong><div class="bar"><i id="happinessBar" style="width:60%"></i></div><div id="happinessVal">60</div></div>
        <div class="stat"><strong>ì—ë„ˆì§€</strong><div class="bar"><i id="energyBar" style="width:70%"></i></div><div id="energyVal">70</div></div>
        <div class="stat"><strong>ì²­ê²°</strong><div class="bar"><i id="cleanBar" style="width:80%"></i></div><div id="cleanVal">80</div></div>
      </div>

      <div class="controls">
        <button class="btn" id="feed">ë¨¹ì´ê¸°</button>
        <button onclick="actionPlay(this)" class="btn" id="play">ë†€ê¸°</button>
        <button class="btn" id="sleep">ì¬ìš°ê¸°</button>
        <button class="btn" id="clean">ì •ë¦¬</button>
        <button class="btn secondary" id="rename">ì´ë¦„ ë³€ê²½</button>
      </div>

      <div class="panel log" id="log">ê²Œì„ ì‹œì‘ â€” ë°˜ê°€ì›Œìš”!</div>
    </section>

    <aside class="right">
      <div class="panel">
        <div class="row"><div><strong id="petName">ì´ë¦„: ë½€ë¡œë¡±</strong><div style="font-size:12px;color:#6b7aa8"></span> ì‹œê°„: <span id="timeAlive">0m</span></div></div><div></div></div>
      </div>

      <div class="panel">
        <h3 style="margin:0 0 8px 0">ìƒíƒœ ì„¤ëª…</h3>
        <p style="margin:0;font-size:13px;color:#39507d">í¬ë§Œê°ì´ 0ì´ë©´ ë§¤ìš° ë°°ê³ í””(ë‚˜ì¨), 100ì´ë©´ ë°°ë¶ˆëŸ¬ìš”.<br>í–‰ë™ ë²„íŠ¼ìœ¼ë¡œ ì¦‰ê° íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ì—ë„ˆì§€ê°€ ë¶€ì¡±í•˜ë©´ ìºë¦­í„°ì˜ í–‰ë™ì´ ì œí•œë©ë‹ˆë‹¤.</p>
      </div>

      <div class="panel">
        <h3 style="margin:0 0 8px 0">ì˜µì…˜</h3>
        <div class="row"><span>ìë™ ì €ì¥</span><label><input type="checkbox" id="autosave" checked> </label></div>
        <div style="height:8px"></div>
      </div>

      <div class="panel" id="achievementsPanel">
  <h3 style="margin:0 0 8px 0">ì—…ì </h3>
  <div id="achievementsList" style="font-size:13px;color:#39507d">
  </div>
</div>
      <div class="panel">
        <h3 style="margin:0 0 40px 0"></h3>
        <div style="height:8px"></div>
        <div>
        <a href="https://www.smu.ac.kr" target="_blank">
          <img src="./image/ìƒëª….jpg"
            alt="ìƒëª…ëŒ€í™ˆí˜ì´ì§€" 
            width="450px">
        </a>
        </div>
        <div class="row"><small></small><span style="font-size:12px;color:#6b7aa8"></span></div>
      </div>

    </aside>
  </div>

  <script>
  /*
    Mini Tamagotchi - single-file educational example
    - Save as tamagotchi.html and open in any modern browser
    - Uses: localStorage, setInterval, DOM updates, simple animations
    - Extend: add images, sounds, more actions, leveling, mini-games
  */

  let achievements = [
  {
    id: 'first_play',
    name: 'ì²« ë†€ì´!',
    desc: 'ì²˜ìŒìœ¼ë¡œ ë†€ê¸° ë²„íŠ¼ì„ ëˆŒë €ìŠµë‹ˆë‹¤.',
    achieved: false,
    check: () => actionCounts.play >= 1
  },
  {
    id: 'clean_master',
    name: 'ì²­ì†Œì™•',
    desc: 'ì²­ì†Œë¥¼ 10ë²ˆ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.',
    achieved: false,
    check: () => actionCounts.clean >= 10
  },
  {
    id: 'happy_100',
    name: 'í–‰ë³µ MAX!',
    desc: 'í–‰ë³µ ìˆ˜ì¹˜ë¥¼ 100ê¹Œì§€ ì˜¬ë ¸ìŠµë‹ˆë‹¤.',
    achieved: false,
    check: () => state.happiness >= 100
  },
  {
    id: 'survive_1_hour',
    name: '1ì‹œê°„ ìƒì¡´!',
    desc: 'í‚¤ìš´ ì‹œê°„ì´ 60ë¶„ì„ ë„˜ì—ˆìŠµë‹ˆë‹¤.',
    achieved: false,
    check: () => state.timeAliveMins >= 60
  }
];

let actionCounts = {
  play: 0,
  clean: 0,
  feed: 0,
  sleep: 0
};

function checkAchievements() {
  achievements.forEach(a => {
    if (!a.achieved && a.check()) {
      a.achieved = true;
      notify(`ğŸ‰ ì—…ì  ë‹¬ì„±: ${a.name}`);
      renderAchievements();
      saveState();
    }
  });
}

function renderAchievements() {
  const box = document.getElementById('achievementsList');
  box.innerHTML = '';

  achievements.forEach(a => {
    const item = document.createElement('div');
    item.style.marginBottom = '6px';

    item.innerHTML = a.achieved 
      ? `âœ… <strong>${a.name}</strong><br><small>${a.desc}</small>`
      : `â¬œ ${a.name}`;

    box.appendChild(item);
  });
}

  // --- Game state ---
  const DEFAULT = {
    name: 'ìˆ˜ëª½ì´',
    hunger: 50,    // 0..100 (0 full, 100 starving)
    happiness: 60, // 0..100
    energy: 70,    // 0..100
    clean: 80,     // 0..100
    timeAliveMins: 0,
    lastTick: Date.now()
  };

  const STORAGE_KEY = 'mini_tamagotchi_v1';
  let state = loadState();

  // DOM refs
  const petFace = document.getElementById('petFace');
  const petView = document.getElementById('petView');
  const bgOverlay = document.getElementById('bgOverlay');
  const hungerBar = document.getElementById('hungerBar');
  const happinessBar = document.getElementById('happinessBar');
  const energyBar = document.getElementById('energyBar');
  const cleanBar = document.getElementById('cleanBar');
  const hungerVal = document.getElementById('hungerVal');
  const happinessVal = document.getElementById('happinessVal');
  const energyVal = document.getElementById('energyVal');
  const cleanVal = document.getElementById('cleanVal');
  const petNameEl = document.getElementById('petName');
  const timeAliveEl = document.getElementById('timeAlive');
  const logEl = document.getElementById('log');

  // buttons
  document.getElementById('feed').addEventListener('click',()=>actionFeed());
  document.getElementById('play').addEventListener('click',()=>actionPlay());
  document.getElementById('sleep').addEventListener('click',()=>actionSleep());
  document.getElementById('clean').addEventListener('click',()=>actionClean());
  document.getElementById('rename').addEventListener('click',()=>rename());
  document.getElementById('saveBtn').addEventListener('click',()=>{saveState();notify('ìˆ˜ë™ ì €ì¥ ì™„ë£Œ')});
  document.getElementById('resetBtn').addEventListener('click',resetGame);
  document.getElementById('autosave').addEventListener('change',()=>{});
  

  // core loop: tick every second but compute deltas for accuracy
  let lastFrame = Date.now();
  function gameLoop(){
    const now = Date.now();
    const dt = now - lastFrame; // ms
    if(dt>=1000){
      tick(Math.floor(dt/1000));
      lastFrame = now;
    }
    requestAnimationFrame(gameLoop);
  }

  function tick(seconds){
    // decay rates per minute => convert from seconds
    // hunger increases (+) meaning worse; other stats decrease (-) meaning worse
    const hungerRatePerMin = 2; // per minute
    const happyLossPerMin = 1;
    const energyLossPerMin = 2;
    const cleanLossPerMin = 1.5;

    checkAchievements();

    const secsPerMin = 60;
    const n = seconds;

    state.hunger = clamp(state.hunger + (hungerRatePerMin/secsPerMin)*n, 0, 100);
    state.happiness = clamp(state.happiness - (happyLossPerMin/secsPerMin)*n, 0, 100);
    state.energy = clamp(state.energy - (energyLossPerMin/secsPerMin)*n, 0, 100);
    state.clean = clamp(state.clean - (cleanLossPerMin/secsPerMin)*n, 0, 100);

    // time alive increase by seconds
    state.timeAliveMins += n/60;

    // change face & reactions
    updatePetAppearance();
    render();

    // autosave occasionally
    const autosave = document.getElementById('autosave').checked;
    if(autosave && Math.random()<0.08) saveState();

    // if any stat critical, push log
    if(state.hunger>90) notify('ì•„ì£¼ ë°°ê³ íŒŒìš”! ë¨¹ì—¬ì£¼ì„¸ìš”!');
    if(state.happiness<10) notify('ìš°ìš¸í•´ìš”... ê°™ì´ ë†€ì•„ì£¼ì„¸ìš”');
    if(state.energy<5) notify('ë„ˆë¬´ í”¼ê³¤í•´ìš”... ì¬ì›Œì£¼ì„¸ìš”');
  }

  /**
   * changeBackground(tempImage, duration)
   * - tempImage: ì´ë¯¸ì§€ ê²½ë¡œ (ë¬¸ìì—´). ex: 'images/feed-bg.jpg'
   * - duration: ë°€ë¦¬ì´ˆ (ê¸°ë³¸ 1000)
   *
   * ë™ì‘: bgOverlayì— ì´ë¯¸ì§€ë¥¼ ë„£ê³  ë¶ˆíˆ¬ëª…ë„ë¥¼ ì˜¬ë¦° ë’¤ duration í›„ì— ë‹¤ì‹œ íˆ¬ëª…í•˜ê²Œ ë§Œë“¤ì–´ ì›ë˜ ë°°ê²½ìœ¼ë¡œ ë³µêµ¬
   * ì•ˆì „ì¥ì¹˜: petView/bgOverlayê°€ ì—†ê±°ë‚˜ tempImageê°€ ë¹„ì–´ìˆìœ¼ë©´ ì•„ë¬´ ë™ì‘í•˜ì§€ ì•ŠìŒ
   */
  function changeBackground(tempImage) {
    if(!petView || !bgOverlay) return;
    if(!tempImage) return;

    // set background image on overlay
    // ë”°ì˜´í‘œë¡œ ê°ì‹¸ ê²½ë¡œì— ê³µë°±ì´ ìˆì–´ë„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
    bgOverlay.style.backgroundImage = `url("${tempImage}")`;
    // ë³´ì´ê²Œ (fade-in)
    // ë¸Œë¼ìš°ì €ê°€ transitionì„ ì¸ì‹í•˜ë„ë¡ ì•½ê°„ì˜ ë”œë ˆì´(ë‹¤ìŒ í”„ë ˆì„) ì ìš©
    requestAnimationFrame(()=> {
      bgOverlay.style.opacity = '1';
    });

    // fade-out ì˜ˆì•½
    setTimeout(()=> {
      bgOverlay.style.opacity = '0';
      // transition ëë‚œ ë’¤ ì‹¤ì œ backgroundImageë¥¼ ì œê±°í•´ì„œ ë©”ëª¨ë¦¬/ë„¤íŠ¸ì›Œí¬ ë¶€ë‹´ ì¤„ì„
      const onTransitionEnd = (e) => {
        if(e.propertyName === 'opacity' && bgOverlay.style.opacity === '0') {
          bgOverlay.style.backgroundImage = '';
          bgOverlay.removeEventListener('transitionend', onTransitionEnd);
        }
      };
      bgOverlay.addEventListener('transitionend', onTransitionEnd);
    }, duration);
  }

  // actions
  function actionFeed(){
    changeStat('hunger', +20); // reduce hunger
    changeStat('clean', -3);
    changeStat('happiness', +5);
    notify('ë¨¹ì´ë¥¼ ì£¼ì—ˆìŠµë‹ˆë‹¤. ëƒ ëƒ ');
    animatePet('');
    changeBackground('mk/ë³‘ì²œìˆœëŒ€.png', 300); // ì„ì‹œ ë°°ê²½ (1ì´ˆ) 
  }

  function actionPlay(){

    if(state.energy<20){ notify('ì—ë„ˆì§€ê°€ ë¶€ì¡±í•´ìš”...'); return; }

    actionCounts.play++;       
    checkAchievements();

    changeStat('happiness', +20);
    changeStat('energy', -15);
    changeStat('hunger', -8);
    notify('ì¦ê²ê²Œ ë†€ì•˜ì–´ìš”!');

    
    switch(Math.floor(Math.random() * (7 - 1 + 1)) + 1)
    {
      case 1: changeBackground('ground/p8.png', 1000);
      break;
      case 2: changeBackground('ground/p2.png', 1000);
      break;
      case 3: changeBackground('ground/p3.png', 1000);
      break;
      case 4: changeBackground('ground/p4.png', 1000);
      break;
      case 5: changeBackground('ground/p5.png', 1000);
      break;
      case 6: changeBackground('ground/p6.png', 1000);
      break;
      case 7: changeBackground('ground/p1.png', 1000);
      
    }
    
  }

  function actionSleep(){

    actionCounts.sleep++;       
    checkAchievements();
    // instant nap
    changeStat('energy', +40);
    changeStat('hunger', -15);
    notify('ì ì„ ì¤ì–´ìš”. ê¸°ìš´ì´ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤. zzz');
    animatePet('');
    changeBackground('mk/ì ìëŠ”.png', 300);
  }

  function actionClean(){

    actionCounts.clean++;       
    checkAchievements();
    changeStat('clean', +40);
    changeStat('happiness', -30);
    changeStat('energy', -15);
    notify('ì²­ì†Œ ì™„ë£Œ! ìƒì¾Œí•´ìš”.');
    animatePet('');
    changeBackground('mk/ì²­ì†Œí•˜ëŠ”.png', 300);
  }

  // helpers
  function changeStat(key, delta){
    state[key] = clamp(state[key] + delta, 0, 100);
    render();
  }

  function animatePet(symbol){
    petFace.textContent = symbol;
    petFace.classList.remove('breath');
    petFace.style.transform = 'scale(1.12)';
    setTimeout(()=>{ petFace.classList.add('breath'); petFace.style.transform=''; updatePetAppearance(); }, 600);
  }

  function updatePetAppearance(){
    // change emoji according to mood
    if(state.energy<20) changeBackground('mk/í”¼ê³¤í•œ.png');
    else if(state.hunger<=20) changeBackground('mk/ë°°ê³ í”ˆ 3.png');
    else if(state.happiness<20) changeBackground('mk/ê¸°ì ˆ1.png');
    else if(state.clean<20) changeBackground('mk/ë”ëŸ¬ìš´(ëª¸ìƒíƒœ).png');
    else
    changeBackground('mk/ê¸°ë³¸.png');
  }

  function render(){
    hungerBar.style.width = state.hunger + '%';
    happinessBar.style.width = state.happiness + '%';
    energyBar.style.width = state.energy + '%';
    cleanBar.style.width = state.clean + '%';

    hungerVal.textContent = Math.round(state.hunger);
    happinessVal.textContent = Math.round(state.happiness);
    energyVal.textContent = Math.round(state.energy);
    cleanVal.textContent = Math.round(state.clean);

    petNameEl.textContent = 'ì´ë¦„: ' + state.name;
    timeAliveEl.textContent = Math.floor(state.timeAliveMins) + 'm';

    renderAchievements();
  }

  function notify(text){
    const t = document.createElement('div');
    t.textContent = `â€¢ ${text}`;
    logEl.prepend(t);
    // limit
    while(logEl.children.length>60) logEl.removeChild(logEl.lastChild);
  }

  function rename(){
    const n = prompt('ìƒˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”', state.name);
    if(n && n.trim()){ state.name = n.trim(); render(); notify('ì´ë¦„ì„ "' + state.name + '"(ìœ¼)ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.'); saveState(); }
  }

  function saveState(){
    state.lastTick = Date.now();
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return {...DEFAULT};
      const s = JSON.parse(raw);
      // basic migration: fill missing keys
      return Object.assign({}, DEFAULT, s);
    }catch(e){ console.error(e); return {...DEFAULT}; }
  }

  function resetGame(){
    if(!confirm('ê²Œì„ì„ ì´ˆê¸°í™” í•˜ì‹œê² ì–´ìš”? ì €ì¥ëœ ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.')) return;
    state = {...DEFAULT};
    localStorage.removeItem(STORAGE_KEY);
    render();
    notify('ê²Œì„ì„ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.');
  }

  function clamp(v,a,b){return Math.max(a,Math.min(b,v));}

  // initial render
  render();
  updatePetAppearance();
  // start loop
  requestAnimationFrame(gameLoop);

  // save before unload
  window.addEventListener('beforeunload',()=>{ saveState(); });

  </script>
</body>
</html>
